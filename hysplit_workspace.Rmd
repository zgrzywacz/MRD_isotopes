---
title: "hysplit_workspace"
output: html_document
---



```{r}
library(splitr)
library(lubridate)
```

```{r}
setwd("./hysplit")
```

```{r}
trajectory <- 
  hysplit_trajectory(
    lat = -41.83989,
    lon = 145.531014,
    height = 10,
    duration = 24,
    days = "2013-01-1",
    daily_hours = c(0, 6, 12, 18),
    direction = "backward",
    met_type = "reanalysis",
    extended_met = TRUE
  ) 
```

```{r}
trajectory_plot(trajectory)
```

```{r}
traj.series <- function (dayDate){
  trajectory <- 
    hysplit_trajectory(
      lat = -41.83989,
      lon = 145.531014,
      height = 10,
      duration = 120,
      days = dayDate,
      daily_hours = c(0, 6, 12, 18),
      direction = "backward",
      met_type = "reanalysis",
      extended_met = TRUE
  ) 
}

endDate <- seq(ymd('2012-11-01'), ymd('2013-02-01'), by = '5 day')

trajL <- lapply (endDate, FUN=traj.series)
trajDF <- do.call(rbind, trajL)
latlons <- data.frame(lon=trajDF$lon, lat=trajDF$lat)
```


```{r}
library("ggplot2")
theme_set(theme_bw())
library("sf")
library("rnaturalearth")
library("rnaturalearthdata")

world <- ne_countries(scale = "medium", returnclass = "sf")
class(world)

ggplot(data = world) +
    geom_sf() +
    geom_point(data = latlons, aes(x = lon, y = lat), size = 0.5, 
        shape = 1, col="grey50") +
    coord_sf(xlim = c(40, 160), ylim = c(-80, -20), expand = FALSE)
```

```{r}
endDate <- seq(ymd('2010-06-01'), ymd('2011-05-31'), by = '5 day')

trajL2 <- lapply (endDate, FUN=traj.series)
trajDF2 <- do.call(rbind, trajL2)
latlons2 <- data.frame(lon=trajDF2$lon, lat=trajDF2$lat)
```

```{r}
ggplot(data = world) +
    geom_sf() +
    geom_point(data = latlons2, aes(x = lon, y = lat), size = 0.5, 
        shape = 1, col="grey50") +
    coord_sf(xlim = c(40, 160), ylim = c(-80, -20), expand = FALSE)
```

